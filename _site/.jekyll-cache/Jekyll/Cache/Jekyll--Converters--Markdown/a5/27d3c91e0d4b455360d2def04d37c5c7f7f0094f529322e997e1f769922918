I"ü
<p>The ExecuteActionStage on Shard Workers can limit the resources available during Command execution per the Platform.</p>

<p>This feature currently requires OS-specific <code class="language-plaintext highlighter-rouge">cgroups</code> support, available in Linux.</p>

<p>The boolean configuration field <code class="language-plaintext highlighter-rouge">limit_execution</code> controls the creation of a worker-wide cgroup. This cgroup currently limits cpu resources to the the ExecuteStageWidth (one core per slot), and other worker-wide cgroup controls may be available in the future. Other limiting fields also require this option to be enabled. This does not mandate that all executions take place in this created cgroup.</p>

<p>If true, the boolean configuration field <code class="language-plaintext highlighter-rouge">limit_global_execution</code> specifies that all executions take place in the above cgroup by default. This currently shrinks the effective cpu area available to be shared by all executions to the width of the execute stage.</p>

<p>With <code class="language-plaintext highlighter-rouge">limit_execution</code> enabled, a Command may request that it be executed with <code class="language-plaintext highlighter-rouge">min-cores</code> available to it (lower bound) and up to <code class="language-plaintext highlighter-rouge">max-cores</code>. These are field <code class="language-plaintext highlighter-rouge">name</code>s in the Platform which are expected to be integers in the string <code class="language-plaintext highlighter-rouge">value</code>. After selective consumption of the superscalar execution slots for <code class="language-plaintext highlighter-rouge">min-cores</code>, the executing processes will be controlled by cgroups <strong>under</strong> the above cgroup to give it as many shares of the total (preferred scheduling) for <code class="language-plaintext highlighter-rouge">min-cores</code>, and have its scheduling quota limited to a fair number consistent with its <code class="language-plaintext highlighter-rouge">max-cores</code>.</p>

<p>The effective Platform of an execution can also be affected by the Workerâ€™s <code class="language-plaintext highlighter-rouge">default_platform</code>, where it can inherit either of <code class="language-plaintext highlighter-rouge">min/max-cores</code> if unspecified.</p>

<p>The Worker configuration field <code class="language-plaintext highlighter-rouge">only_multicore_tests</code> can further affect the values of <code class="language-plaintext highlighter-rouge">min/max-cores</code> by clamping them to 1 if enabled, based on the detection of â€˜bazel-likeâ€™ test environments for executions: The detection of an environment variable XML_OUTPUT_FILE under the command is the current qualifier</p>
:ET